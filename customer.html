<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å 30 ‡∏õ‡∏µ CS</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #ffe0f0, #e0f7ff);
      margin: 0;
      padding: 40px;
      color: #5b3b74;
    }
    .container {
      max-width: 650px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 18px;
      box-shadow: 0 10px 25px rgba(190, 170, 255, 0.2);
    }
    h2 {
      text-align: center;
      color: #a673c6;
      font-weight: 700;
      font-size: 26px;
    }
    label {
      margin-top: 15px;
      display: block;
      font-weight: 600;
      color: #6a5485;
    }
    input, select, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #e8d4fa;
      border-radius: 10px;
      background-color: #fdfaff;
      font-size: 14px;
      box-sizing: border-box;
    }
    button {
      width: 100%;
      padding: 12px;
      background: linear-gradient(to right, #fcbfdc, #d3a5f7);
      color: white;
      border: none;
      border-radius: 10px;
      margin-top: 25px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background: linear-gradient(to right, #ffd4e8, #c9a7f5);
    }
    .product-item {
      margin-bottom: 20px;
      border-bottom: 1px solid #f1e5ff;
      padding-bottom: 15px;
      position: relative;
    }
    .summary {
      background: #f5ebff;
      border-radius: 10px;
      padding: 15px;
      margin-top: 15px;
      font-weight: 600;
      color: #8c56ac;
    }
    .summary strong {
      color: #9446b6;
    }
    .product-label-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 15px;
    }
    .delete-button {
      color: #d33;
      font-size: 14px;
      cursor: pointer;
      font-weight: 700;
      margin-left: auto;
    }
    .delete-button:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å <span class="highlight">30 ‡∏õ‡∏µ CS</span></h2>
    <form id="orderForm">
      <label>‡∏ä‡∏∑‡πà‡∏≠</label>
      <input type="text" name="firstname" required>

      <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
      <input type="text" name="lastname" required>

      <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
      <textarea name="address" rows="3" required></textarea>

      <label>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
      <input type="tel" name="phone" required pattern="0[0-9]{8,9}">

      <div id="productContainer"></div>
      <button type="button" onclick="addProductItem()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>

      <label>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</label>
      <select name="deliveryOption" onchange="calculateTotal()">
        <option value="pickup">‡∏£‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á ‡∏´‡πâ‡∏≠‡∏á‡∏ä‡∏°‡∏£‡∏°‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏∂‡∏Å 60 ‡∏õ‡∏µ ‡∏ä‡∏±‡πâ‡∏ô 6 ‡∏°.‡πÅ‡∏°‡πà‡πÇ‡∏à‡πâ</option>
        <option value="delivery">‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏Ç‡∏ô‡∏™‡πà‡∏á +50 ‡∏ö‡∏≤‡∏ó (‡∏ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô 5 ‡∏ï‡∏±‡∏ß +‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏•‡∏∞ 10 ‡∏ö‡∏≤‡∏ó)</option>
      </select>

      <div class="summary">
        üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: <strong><span id="finalPrice">0.00</span></strong> ‡∏ö‡∏≤‡∏ó
      </div>

      <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</label>
      <input type="date" name="orderDate" required>

      <label>‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</label>
      <div style="background:#f3f0ff;border:1px solid #d3c8f3;padding:12px;border-radius:10px;margin-bottom:10px;">
        <strong>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</strong> : 678-0-07822-3<br>
        <strong>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</strong> : ‡∏ô‡∏≤‡∏¢‡∏†‡∏≤‡∏ô‡∏∏‡∏ß‡∏±‡∏í‡∏ô‡πå ‡πÄ‡∏°‡∏Ü‡∏∞, ‡∏ô‡∏≤‡∏¢‡∏≠‡∏£‡∏£‡∏ñ‡∏ß‡∏¥‡∏ó ‡∏ä‡∏±‡∏á‡∏Ñ‡∏°‡∏≤‡∏ô‡∏ô‡∏ó‡πå,<br>
        ‡∏ô‡∏≤‡∏á‡∏õ‡∏£‡∏≤‡∏ì‡∏µ ‡∏Å‡∏±‡∏ô‡∏ò‡∏¥‡∏°‡∏≤ (‡∏ä‡∏°‡∏£‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå)<br>
        <strong>‡∏™‡∏≤‡∏Ç‡∏≤</strong> : ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÅ‡∏°‡πà‡πÇ‡∏à‡πâ
      </div>

      <label>‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</label>
      <input type="file" name="paymentSlip" id="paymentSlip" required>

      <button type="submit">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
    </form>

  </div>

<script>
let productIndex = 0;

function getProducts() {
  return JSON.parse(localStorage.getItem('products') || '[]');
}

function getOrders() {
  return JSON.parse(localStorage.getItem('orders') || '[]');
}

function addProductItem() {
  const cont = document.getElementById('productContainer');
  const div = document.createElement('div');
  div.className = 'product-item';
  div.id = 'prod_' + productIndex;

  const map = {};
  getProducts().forEach(p => map[p.productName] = p.price);
  let options = Object.entries(map).map(([n, p]) => `<option value="${n}">${n} (${p} ‡∏ö‡∏≤‡∏ó)</option>`).join('');

  div.innerHTML = `
    <div class="product-label-container">
      <label>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
      <span onclick="removeProd(${productIndex})" class="delete-button">‡∏•‡∏ö</span>
    </div>
    <select name="product_${productIndex}" onchange="calculateTotal()" required>
      <option value="">--‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤--</option>${options}
    </select>
    <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
    <input type="number" name="quantity_${productIndex}" value="1" min="1" onchange="calculateTotal()" required>
  `;

  cont.appendChild(div);
  productIndex++;
}

function removeProd(i) {
  document.getElementById('prod_' + i)?.remove();
  calculateTotal();
}

function calculateTotal() {
  let tot = 0;
  let totalQty = 0;
  const map = {};
  getProducts().forEach(p => map[p.productName] = p.price);

  for (let i = 0; i < productIndex; i++) {
    const sel = document.querySelector(`[name="product_${i}"]`);
    const qty = document.querySelector(`[name="quantity_${i}"]`);
    if (sel && sel.value && qty) {
      const quantity = parseInt(qty.value);
      tot += map[sel.value] * quantity;
      totalQty += quantity;
    }
  }

  const delivery = document.querySelector('select[name="deliveryOption"]').value;
  if (delivery === 'delivery') {
    let shippingCost = 50;
    if (totalQty > 5) {
      shippingCost += (totalQty - 5) * 10;
    }
    tot += shippingCost;
  }

  document.getElementById('finalPrice').innerText = tot.toFixed(2);
}

document.getElementById('orderForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const form = this;
  const prods = [];
  for (let i = 0; i < productIndex; i++) {
    const sel = form[`product_${i}`];
    const qty = form[`quantity_${i}`];
    if (sel && sel.value && qty) {
      prods.push({ product: sel.value, quantity: parseInt(qty.value) });
    }
  }

  if (prods.length === 0) {
    alert('‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
    return;
  }

  const orders = getOrders();
  orders.push({
    firstname: form.firstname.value,
    lastname: form.lastname.value,
    phone: form.phone.value,
    address: form.address.value,
    products: prods,
    deliveryOption: form.deliveryOption.value,
    paymentMethod: "‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô",
    orderDate: form.orderDate.value,
    total: document.getElementById('finalPrice').innerText
  });

  localStorage.setItem('orders', JSON.stringify(orders));
  alert('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');

  form.reset();
  document.getElementById('productContainer').innerHTML = '';
  productIndex = 0;
  addProductItem();
  calculateTotal();
});

window.onload = () => {
  if (!localStorage.getItem('orders')) localStorage.setItem('orders', '[]');
  addProductItem();
  calculateTotal();
}
</script>
</body>
</html>
